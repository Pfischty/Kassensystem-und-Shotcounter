{% extends "base.html" %}
{% block title %}Shotcounter{% endblock %}
{% block header %}{% endblock %}
{% block content %}
<h1>Shotcounter – {{ event.name }}</h1>

<div style="margin-bottom: 1rem; display:flex; gap:0.75rem; flex-wrap:wrap;">
  <a class="button" href="{{ url_for('shotcounter_touch') }}">Touch-Eingabe öffnen</a>
  <a class="button secondary" href="{{ url_for('shotcounter_leaderboard') }}" target="_blank">Leaderboard anzeigen</a>
</div>

<div class="card">
  <h2>Team hinzufügen</h2>
  <form method="post" action="{{ url_for('add_team') }}">
    <input
      name="team_name"
      placeholder="Teamname"
      required
      pattern="[A-Za-z0-9ÄÖÜäöüß .,'&()/\\-]+"
      title="Erlaubt sind Buchstaben, Zahlen, Leerzeichen sowie . , - _ & / ( ) '"
      autocomplete="off"
    >
    <input type="hidden" name="next" value="{{ url_for('shotcounter') }}">
    <button type="submit">Anlegen</button>
  </form>
</div>

<div class="card">
  <h2>Shots verbuchen</h2>
  {% if not teams %}
    <p>Noch keine Teams vorhanden.</p>
  {% else %}
    <table>
      <tr><th>Team</th><th>Shots</th><th>Aktion</th><th>Team löschen</th></tr>
      {% for team in teams %}
        <tr>
          <td>
            <form class="inline" method="post" action="{{ url_for('update_team', team_id=team.id) }}">
              <input
                type="text"
                name="team_name"
                value="{{ team.name }}"
                required
                pattern="[A-Za-z0-9ÄÖÜäöüß .,'&()/\\-]+"
                title="Erlaubt sind Buchstaben, Zahlen, Leerzeichen sowie . , - _ & / ( ) '"
                style="min-width: 200px;"
              >
              <input type="hidden" name="next" value="{{ url_for('shotcounter') }}">
              <button type="submit">Name speichern</button>
            </form>
          </td>
          <td>
            <form class="inline" method="post" action="{{ url_for('update_team', team_id=team.id) }}">
              <input
                type="number"
                name="shots"
                min="0"
                value="{{ team.shots }}"
                style="width:80px;"
                required
              >
              <input type="hidden" name="next" value="{{ url_for('shotcounter') }}">
              <button type="submit">Shots setzen</button>
            </form>
          </td>
          <td>
            <form class="inline" method="post" action="{{ url_for('add_shots') }}">
              <input type="hidden" name="team_id" value="{{ team.id }}">
              <input type="number" name="amount" min="1" value="1" style="width:70px;">
              <input type="hidden" name="next" value="{{ url_for('shotcounter') }}">
              <button type="submit">+ Shots</button>
            </form>
          </td>
          <td>
            <form
              class="inline"
              method="post"
              action="{{ url_for('delete_team', team_id=team.id) }}"
              onsubmit="return confirm('Team wirklich löschen?');"
            >
              <input type="hidden" name="next" value="{{ url_for('shotcounter') }}">
              <button type="submit" class="danger">Löschen</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </table>
  {% endif %}
</div>

{% endblock %}
